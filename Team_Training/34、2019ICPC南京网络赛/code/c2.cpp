
#include<bits/stdc++.h>
using namespace std;
#define fi first
#define se second
#define pb push_back
#define mp make_pair
#define rep(i, a, b) for(int i = (a); i < (b); ++i)
#define per(i, a, b) for(int i = (b) - 1; i >= (a); --i)
#define de(x) cout << #x << " = " << x << endl
#define dd(x) cout << #x << " = " << x << " "
#define endl '\n'
#define pw(x) (1ll<<(x))
#define sz(x) (int)x.size()
#define all(x) x.begin(), x.end()
typedef double db;
typedef pair<int, int> pii;
typedef vector<int> vi;
typedef long long ll;

const int P = 998244353;
const int N = 1e5 + 5;
int T;
ll a[N], c[N], b[N], m, sum, now;
int cnt[N];

int ans[] = {0,
356412117,729180981,436041614,288180110,182120812,299901719,457314620,18285640,800927884,649836142,369555165,519495062,145596728,206687588,989289255,778633370,25807370,122785591,805648643,997537056,852982367,116731249,500283943,135136352,614749995,368878844,847025616,159456299,705619222,437866561,197611523,26789862,96962651,37726972,852143802,233523510,72663690,418984110,165303740,168581843,576476222,302380248,387649349,109858577,283217135,675277626,573522306,356337684,777135139,248904938,654690469,799772319,72426689,430939043,950532928,698417406,126338143,441289716,629654913,834089625,482593408,558386955,34797942,537710140,276766501,177414225,754010781,972104075,483258691,992428214,443380598,26860260,396217451,68241893,456894370,687580431,248354261,873760440,153472144,554668188,771502255,830383830,655046067,225719070,144951852,455952918,674711418,942917466,272017441,460156336,861178496,859876313,464947191,63849583,471055100,992729873,728539261,188868239,921380144,991727842,10266836,905437059,3121982,662977706,154422130,494231002,736240951,409684085,361311266,175966526,283115555,563118370,179486157,631199505,804491481,953053693,385025192,28932993,978250023,708913202,383339705,901272505,811734484,751924893,294038236,257230010,575890586,466042537,691849340,361237918,36961629,400031597,459997763,286633598,225763268,713762848,933043359,605555990,528086801,72968107,911285925,333281486,758438000,165769177,227236192,46337469,504586486,38027992,79502937,421175253,543837348,970091810,505645257,605694297,992901714,589343907,238817492,618765150,553559933,481943124,294041178,249219307,299870160,205061197,319913764,350788157,495316507,539966598,82559098,438699912,620383075,274791112,255922102,977415181,39109921,659906536,808756067,395671597,360391874,983735984,119816615,803092519,846677082,92135823,897654196,593500787,952323550,675731447,906042700,142289207,97321588,82352606,712719401,593552030,549603447,957126597,800752663,133665095,575538799,681846657,875379591,497866723,636021904,79807258,740487257,557503702,60968207,454807751,371889158,35893264,612436480,608750823,651952671,620259953,247117734,317760326,221719281,547601381,628847687,898650875,219978271,824061504,946565284,76695767,516183865,716469173,236891854,336811955,267801599,376697863,806879164,892810207,527970197,451510528,819948301,228242159,558905950,325832884,718705544,840500943,301561480,833143348,64533691,931911095,641438071,751862244,699552581,588277783,77572953,735741561,865420672,249370189,610681383,777716699,715800045,787701193,269730361,688614880,854945151,160623260,166923984,952347557,936803877,835098184,731731293,112815730,2183280,426767550,817376943,281665565,585685469,740741995,729946174,472502607,709200896,466930013,380520658,302002332,877329360,264668973,836635636,931905454,687384521,634154122,633889264,344340043,902509011,581893642,860354269,455547187,404874887,993022810,682316551,937191470,337993543,264765973,690427552,347023975,880418178,580103098,208143858,199228654,742637993,85146459,5548782,886426086,658320604,709644199,838405914,949293076,614984306,715309387,492325506,591559685,125961751,956356804,320708689,437576549,850821125,834592240,300901709,501381751,552993219,346938833,418417385,107216653,974165292,268118227,516064006,160152100,95127758,268013930,293086665,652956460,231753195,175802335,72656613,612470000,377844669,702170472,339459916,601361943,990134897,730612407,128235897,736218254,899848774,49464244,84064688,595227592,994454883,123577027,202170545,875871130,430139131,83809521,550483772,436731378,509716088,219754484,319412580,414408118,647437072,972112091,343929453,187355209,422752475,705058520,23514241,143174108,575851091,263717631,759348784,536155390,738970685,698121982,749705337,482747029,824744197,890433143,884282243,741390367,682434323,752183796,308045563,114127969,727399888,80099895,18040117,253956681,120567832,716787567,117054287,371031463,677415553,926401267,210212729,726556156,674981569,212509781,56836118,479195575,643212374,766997781,871279220,822096955,985750181,503893926,206699775,92493442,770866009,271072397,925904643,544109706,388981716,400565448,966193788,715572187,553269992,173766184,704678076,654930583,450699680,611492028,861165299,975969000,746789149,97760938,113821993,898691572,84334070,570014849,486474270,82525919,702471490,178277083,310325373,175471233,626813314,119464096,906702878,367013056,97999482,842252381,708889984,807186723,3501643,535565465,849990141,833573763,20935673,808131342,696132054,233894345,552568139,599140122,549751173,28075209,926090397,302526766,269069062,670522683,995678780,297234815,465964629,169326054,851651527,27251114,281652890,346229764,581490076,543236202,646903286,184026776,683542996,772854137,37483853,144245176,597302298,333949083,806363917,437833001,322910272,119334115,806064582,976294551,599233483,792276197,731404369,277613733,492717104,572880386,722624617,609235134,704569802,733771801,673765851,503213626,596053580,30724514,22539954,416722190,259632705,26173831,500836025,130601918,313266125,436057711,400749003,673618010,528357473,499790216,450373907,442209635,8225518,334581933,820789923,945689540,644502028,551499386,236132587,719565874,694231305,332236498,251336682,451020980,760449514,105157949,849558142,343157836,677606295,838932389,795560938,91286836,251708861,423730093,374266868,183889820,199671416,142664018,821497945,291971316,360356228,649922500,354423153,142282514,636799969,200132773,802012832,376679776,868624024,304967043,60910670,236719197,576633197,188629814,765436704,258007528,44221733,783717492,288460328,335376059,530935857,147570282,480327000,120301264,894795409,724353762,615501865,186520637,164277804,24396445,536156396,292856776,835312607,550306590,990821646,200971127,807148027,171342720,113341010,529779333,132195584,736564769,681726764,730686156,326238124,176160606,454012463,151062437,143312862,219756025,853622986,442779635,675929060,9101087,974664401,562704836,376800844,127944811,657266686,186623162,205788758,128212125,206328164,204105392,724634378,420756131,452386943,240575425,752216518,649152554,579369490,865928233,220384603,542276471,184148300,104310159,229233434,104536141,634991804,488411821,983889555,45374893,97719566,405981996,116240985,290090469,913949021,772090416,484800232,733983979,72663426,216989317,754887008,645474370,614880543,889108991,184242819,11067475,671150960,724286141,867277336,673940862,576496916,337945168,356015137,609287087,943672009,168924703,657205666,617741346,634804515,591568662,658752100,966462308,833544660,667563147,479314726,283435916,926831291,451363005,729915315,250713828,229120070,745093632,730085238,111783307,710913751,244337749,795037009,917458046,768887670,693006995,260720101,1623956,939975857,216776255,692530264,332568941,667793980,659270311,585705244,568022854,401710720,5548575,578696950,363405278,226506616,973329373,142557578,196714637,312964064,709317869,280685846,744658363,594637666,550028435,26920570,683588374,487395514,207277848,619149040,263173279,781084634,104880412,972561745,56563632,241816817,802548854,683296577,485158055,825508159,562031445,581154945,510750184,171744343,171897617,518873227,445503976,219400334,143121834,541736639,359258847,978607737,317429378,784737566,782301072,149531448,323499713,139446935,216376982,587214616,334335444,49975006,465351706,901397743,468764169,463142008,932612632,689867780,563452249,591580027,276514478,733552411,12205771,141562846,416854919,579361258,97299944,660080343,644667409,871357712,692157093,868562154,963943909,783515065,237823495,155563353,596046209,728304013,934240056,655414443,911289563,315333784,625263924,868647280,678853014,338208792,822435143,816081083,863625427,697343946,618876020,834284577,851617697,658546167,641193144,479833281,357128525,544601654,247141090,718870631,769574379,723189733,563627558,989922371,665929031,641251172,263247640,265063976,825337551,26941747,679540885,56112378,449669089,837522451,373432029,106610818,896798959,451495807,958965832,850900693,507490022,213828601,313378570,979267132,774706424,653268329,292390165,661419466,955423870,990476643,610437622,408001910,520974868,421506754,884880026,256891047,561832904,655205157,141711168,376884325,625861246,949463306,253494048,116055244,104363099,182906854,438774659,91388223,13253923,625091716,786716109,826168514,370156284,477527140,201887446,358885296,667676420,650672521,384844386,945020961,716647564,371886342,390244051,427078509,310802865,629637548,628205003,760901040,237925266,216279948,261401633,717365012,104614820,815465563,135130710,496976218,352321968,98168806,588167384,672323484,451972752,796690601,390506399,937675837,502204326,391973961,615218941,816322806,718978818,378138352,892454073,587182044,351214118,938080453,375399620,777221036,778142574,535763357,292945932,556409365,609953871,711551706,557529002,474185326,823313870,40561619,168667246,76262462,169775597,551926896,321223547,181644745,984545425,703175820,923454277,459576564,533627285,245304250,486049545,25266780,872532236,422426295,316178262,716343246,541478656,371494576,57483623,979131491,58630096,513341902,143849650,745251254,140862921,420437247,438714410,939064046,458844962,826080371,304985000,732562056,465895305,536335784,285046366,427655106,878664895,473288246,767735318,633384679,108770491,467378855,400763542,776481332,270549850,44596873,348021730,209957524,861912056,850175830,935997311,434436650,90093950,546235726,414811875,15947414,947164150,64076076,161429582,40059585,732153395,757589239,200068048,311513213,221192546,746316243,220884766,118955222,963000049,987734408,144937409,292649604,636392721,878422750,642232332,241796374,7924879,246939632,556522275,748354904,127007370,344053882,251555185,5585665,349109793,505248318,159238993,971546372,733497570,18244532,879998165,863632512,353219996,286064922,210629353,212313686,534678725,191010868,763431315,196812142,596109844,441572092,799001090,331074516,821542587,27060635,281955649,305622706,423502079,518763364,613230211,740883561,781805001,31539784,462999616,538536227,814983204,659409667,481765206,685242096,566058427,259727070,883006428,497751112,7431893,380833269,627849795,310391960,857136152,400951538,384463985,12721407,612815231,79612908,809701562,837654294,736267848,10804010,814196395,692104961,655824012,242353943,746196976,736681195,38704285,23091349,73408127,203268624,896844104,107238384,692199121,187228543,402172515,325308779,84358875,447477475,740630981,812965345,902093006,361559281,971493526,64338223,408433954,246493214,770634914,219188096,360687624,577424447,959436076,739524253,95048492,418342739,710095629,884510650,624567788,673084280,806389159,69966950,288201947,100584518,657568743,861456253,578253637,726055271,748128222,772180311,770513926,393399275,387058737,592656391,340917722,404335188,293519416,813119600,493618445,885585717,435976904,728590994,502607003,401265471,944579159,108096095,389530655,772010091,971447108,70837050,172185051,337538942,253354510,145039783,686034655,229142356,931846684,507136223,718543259,705835605,227186737,683723834,157464250,617606158,591506051,625533761,202635221,702181272,977352572,650870229,286142942,158590464,322372788,229075280,516442625,154737313,704676405,77366044,122833744,434130977,358435893,437945002,760760260,731591023,15971577,844414497,302398398,568724658,548321177,784372611,242665721,852058023,171993707,644405125,591631142,802528630,948437031,875217955,125237295,394928908,940363927,715557141,700263159,747913359,432017948,715408366,939420221,557205019,298611521,722133375,302344592,561587792,512755914,517174452,765865062,614558786,622633017,671588215,923389779,692610007,701057647,351923405,972493737,935860521,472871544,133686128,769472656,953979964,670389146,670460388,335220319,311393467,543146643,475281594,545076521,641759753,506092152,345982123,867499017,858020339,617061983,632682153,693757790,335556043,198436665,86920102,362267192,788040431,615797128,320059055,798939966,307632873,521051155,271969849,233408005,650528036,820525106,55740496,848832764,117213421,295616966,958107949,855820912,3917934,226044579,617486183,260716477,271168246,854584508,755320232,543367076,475849565,220515914,178453755,875435967,381704049,15221362,965051178,472172012,614346523,364710660,314723915,603351726,335383398,241381616,607338858,145874897,504316032,257873680,134824448,131565321,220061582,561850156,552720802,31817213,459718503,641518779,489671907,652830852,713810671,673211337,668371709,156065813,270197609,177802494,686988007,391746124,123735252,885367611,25001069,974443678,718966757,768967864,978301496,624829600,284257931,604087173,65003447,813551445,561212774,603287824,569469969,800082061,275626192,527861000,726731405,754314542,114507961,539445949,729801661,395879952,860959137,21153963,534223496,573219312,783765461,998094857,299962446,219646744,864524302,157119758,74576207,225388703,350929189,12636686,877022563,111520427,458984466,299989300,109761824,8984097,915219021,295021134,581882805,430915063,540837178,6034266,779611413,777238857,618753992,587126912,703648749,901267303,462692881,275827995,847263553,408777782,342441541,783324340,179268688,91972340,661636582,160408106,81266132,188108372,492551869,76019167,606250854,177535708,934131159,907070394,876950182,481259050,922810390,715723542,660641830,189400260,268885415,291482191,792388511,137263291,631575086,988276092,704384815,793753483,582389248,920433973,923581221,55737191,202615790,478487323,439101709,14484585,417370103,560439407,803557178,559530067,119252662,923398751,382391064,278075273,941376093,254947293,576050741,651726967,198238453,394487070,380263006,895381681,275438941,673361774,46425829,8526617,781594004,453261988,77930233,260809550,961086797,680826752,789756965,421500259,181909294,258332268,44206906,932916716,321408170,848137687,37610047,620130445,262798227,415479225,223431386,700857694,718792194,679863559,909877670,372366568,377925918,486378288,540377650,965152216,173102673,30253586,453252275,219271117,131322212,376816483,57909536,359037565,850291776,783438300,55912580,450098753,577333378,652460119,727836269,488621098,518472493,522948967,314403535,857699909,520609889,573673991,67622903,106015698,220193462,476278934,593611083,538196485,917247333,62612823,375165881,813559441,882898165,663655852,612256498,982529097,136799855,461761495,567275949,284524003,615160556,856292063,501074809,826616809,328349552,896182952,717583924,248310301,108714694,347245877,939124395,398916218,250807286,368406541,957220519,388881103,49198918,859119190,865869186,589522883,695306994,532171323,660183382,1416003,252828777,294545265,415654004,493235380,680126686,45804678,347431295,145095489,375377590,805662595,685702975,561951981,16212052,840481039,110709571,506031194,123222949,460391809,476664590,576691430,779314011,692643384,802038942,681967929,427763158,33918768,864594780,102512885,693826061,884780811,921146162,727952508,843072144,137512367,122096669,196507825,350010226,181718235,531768096,247251964,257238874,764341506,237831369,220195198,656521131,43528882,717466085,245781866,142466505,954169057,745305450,602649759,289220495,536020206,723048531,757222813,566040363,430614334,414803686,428035989,652309694,285087842,737846629,642558876,560947086,591736688,114755010,832044779,349961136,335164179,543291877,52563734,121863483,822927163,837422360,384248800,384652256,421805708,850404179,400902806,658882823,749165299,883095135,55416828,534919775,1552885,830192509,376328005,340605212,451387375,590247858,680107498,135618635,813697426,23487219,414351433,849270985,44350003,361728545,997402409,600713155,803107862,455062987,409409378,86698765,320314663,548643336,542914314,888280901,433727071,34488079,293197100,786266559,59965863,299410921,316720528,695642163,40639263,76404332,780777163,58272965,274709696,24417287,876879724,902230247,197406481,193094681,978225911,468356656,913206802,447194690,18582981,35694735,939303924,979690019,811365530,895946826,470128037,663921306,367547156,657965057,975085467,548357080,459273786,127560839,913197538,51605011,207725025,391682910,584795803,895716230,725223413,863862042,378148685,121442625,69606437,721242783,168737316,320936827,630402123,803297679,665885177,385349215,592305576,531280050,482517555,308579784,953039506,104783192,454611552,199743385,372566771,234139325,734686272,451497165,950433052,668072074,240643575,892733468,442096090,66943513,626766676,36987981,811574737,143877955,872066905,59268663,764065495,471334759,332657078,370372989,676708638,941111842,200890322,605053415,372432641,688929718,593945667,913355001,692343059,971114498,248152275,240430746,678885312,802871012,670081550,550487280,279188578,781068386,923701065,126999574,367560552,115312968,119463848,880027353,639743869,266309460,92805283,782906330,201311862,736960174,533102365,18963443,2397396,150465368,760207339,491018775,543144541,840028653,149232607,992569304,52465687,841623205,566501083,952736077,718142914,412952188,468722643,56833821,914532462,962895675,751397413,768979427,449103830,347508675,60051421,553078769,5886957,515807777,244600557,965759297,787980380,556380857,10679970,204685150,424963865,980530267,340303476,196389173,973602949,559546538,227523359,722242007,311504760,716379409,870010498,620970161,596365442,171860383,918222016,71477875,760647016,301029984,487824465,534264169,699084485,799767078,464297419,603858894,578571657,784754718,381169861,724024170,116639653,748196952,171333633,420193707,116061021,599189700,853729356,663910357,1629694,162261380,726850736,637787067,607422907,906397498,762456662,764187298,635118213,50497162,97869056,768748613,67644061,35914957,978979091,657902196,933963374,677053492,11986401,720007584,801714898,103670497,460056083,29134012,616673328,827639819,706167682,387729493,838151545,871062925,542653961,476466991,379551879,658053308,932059558,654365519,211874964,27797999,32628841,847118340,772734967,547422086,539785808,255587641,780756116,681289385,360945515,339913577,867546379,881410769,326577449,178330429,453876532,459665912,665429612,646559285,8039060,550433681,561729711,631762016,446566792,288177346,610807233,785254792,379569908,816955720,589598836,547694107,973082884,463783126,636435345,483809024,72912731,804597925,86804971,410481249,991256624,569441060,310704686,911532168,23256099,143611762,674461862,660934717,764916604,253787038,690857257,434749548,965185186,840252866,481839869,198048890,742491652,702672887,302876707,935905604,361835448,67686890,91901458,539512755,874254199,621331985,632163003,662812559,523545612,27644577,741602168,181511401,391434849,64402910,957549173,353719166,771145675,389965911,232723593,287618870,112686331,191817503,422251434,209391355,922668871,574291658,257232443,998216260,497378170,399680516,398539605,986789260,109127505,369599199,471686220,914039416,108962248,531370343,877573375,853586178,227837381,375585444,863749119,298391362,182216497,81713560,831284601,488349155,977898111,585469258,417498107,789281931,350420374,185787141,788712429,851614075,455110607,27586753,159158959,704508850,837054871,634816784,943063701,204368506,490913001,618202325,667885189,437112809,101223018,133283625,731493137,180515656,186037510,969679450,398309693,12347879,969138204,872480180,247770886,929319581,2759498,499239346,481725299,28537530,170694365,583324171,543618892,909819833,430007665,867056424,131749331,283877453,640759650,439395707,32410998,773750743,425460942,360245657,496566260,254388356,144706434,956559157,713108694,636126668,390051624,129071182,726885402,39159058,942513508,113538725,684285893,573539340,13227027,712166429,382720630,699392719,302906231,512221528,750023922,913731072,997334337,201843845,692179345,332378483,361712248,559674970,172404136,935233064,960053832,22173992,106318990,600644705,556471595,676804359,158277590,481332837,919257895,582055347,379727960,909263812,767238619,801557768,973425483,157255527,598872735,950686726,619974953,727644758,722358749,477406258,408426040
};


const int B = N / 2000;

unordered_map<int, int> M;

int phi(int n) {
	if (M.count(n)) return M[n];
	int r = n, nn = n;
	for (int i = 2; i * i  <= n; i ++) if (n % i == 0) {
		r = r / i * (i - 1);
		while (n % i == 0) n /= i;
	}
	if (n > 1) r = r / n * (n - 1);
	return M[nn] = r;
}

int kpow(int a, ll b) {
	b %= (P - 1);
	int r = 1;
	while (b) {
		if (b & 1) r = 1ll * r * a % P;
		a = 1ll * a * a % P;
		b >>= 1;
	}
	return r;
}

int main() {
	//std::ios::sync_with_stdio(0);
	//std::cin.tie(0);
	int n = 1e5;
	rep(i, 1, n+1) a[i] = phi(i);
	//sort(a+1, a+n+1);
	//int m = unique(a+1, a+n+1) - a;
	//cout << m << endl;
	/*rep(i, 1, n+1) {
		int t = 0;
		rep(j, 1, i) {
				t = t + 1ll * a[i] * a[j] % P * kpow(2, a[i] * a[j]) % P;
				if (t >= P) t-= P;
		}
		de(i);
		s = (s + t) % P;
		if (i % B == 0) b[++m] = s, c[m] = i;
	}*/
	rep(i, 1, n+1) if (i % B == 0) c[++m] = i;
	cin >> T;
	rep(cas, 0, T) {
		cin >> n;
		per(i, 0, m+1) if (n >= c[i]) {
			sum = ans[i]; now = c[i];
			break;
		} 
		rep(i, 1, n+1) cnt[i] = 0;
		rep(i, now+1, n+1) {
			int t = 0;
			rep(j, 1, i) cnt[a[j]]++;
			rep(j, 1, n+1) if (cnt[j]) {	
				t = t + 1ll * a[i] * j % P * kpow(2, a[i] * j) % P * cnt[j]% P;
				if (t >= P) t-= P;
			}
			rep(j, 1, i) cnt[a[j]]--;
			/*rep(j, 1, i) {
				t = t + 1ll * a[i] * a[j] % P * kpow(2, a[i] * a[j]) % P;
				if (t >= P) t-= P;
			}*/
			sum = (sum + t) % P;
		}
		sum = (sum * 2) % P;
		rep(i, 1, n+1) {
			sum = (sum + 1ll * a[i] * a[i] % P * kpow(2, a[i] * a[i]) % P) % P;
		}
		cout << sum << endl;
	}
	//de(m);
	//rep(i, 1, m+1) cout << b[i] << ",";
	return 0;
}
